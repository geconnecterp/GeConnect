@model GridCoreSmart<LMayorAcumuladoDiaDto>

<div class="card">
    <div class="card-header bg-light">
        <h6 class="mb-0">Mayor por Día</h6>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table id="tbMayorDiario" class="table table-sm table-hover mb-0">
                <thead class="table-dark">
                    <tr>
                        <th>Fecha</th>
                        <th class="text-end">Debe</th>
                        <th class="text-end">Haber</th>
                        <th class="text-end">Saldo</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.ListaDatos == null || Model.ListaDatos.Count == 0)
                    {
                        <tr>
                            <td colspan="4" class="text-center">No se han encontrado movimientos.</td>
                        </tr>
                    }
                    else
                    {
                        // Saldo anterior
                        <tr class="saldo-anterior">
                            <td>Saldo Anterior</td>
                            <td class="text-end"></td>
                            <td class="text-end"></td>
                            <td class="text-end">@Model.FormatearDato(Model.ListaDatos.FirstOrDefault()?.saldo_anterior ?? 0, FormatDato.Monto)</td>
                        </tr>

                        foreach (var item in Model.ListaDatos)
                        {
                            <tr data-fecha="@item.fecha_str" class="fila-datos">
                                <td>@item.fecha_str
                                    <button type="button" class="btn btn-sm btn-link p-0 ms-2 ver-detalle"
                                            data-fecha="@item.fecha_str" title="Ver detalle">
                                        <i class="bx bx-search-alt"></i>
                                    </button>
                                </td>
                                <td class="text-end">@Model.FormatearDato(item.total_debe, FormatDato.Monto)</td>
                                <td class="text-end">@Model.FormatearDato(item.total_haber, FormatDato.Monto)</td>
                                <td class="text-end">@Model.FormatearDato(item.saldo_final, FormatDato.Monto)</td>
                            </tr>
                        }

                        // Totales
                        <tr class="table-info">
                            <td class="fw-bold">Totales</td>
                            <td class="text-end fw-bold">@Model.FormatearDato(Model.ListaDatos.Sum(x => x.total_debe), FormatDato.Monto)</td>
                            <td class="text-end fw-bold">@Model.FormatearDato(Model.ListaDatos.Sum(x => x.total_haber), FormatDato.Monto)</td>
                            <td></td>
                        </tr>

                        // Saldo actual
                        <tr class="saldo-actual">
                            <td>Saldo Actual</td>
                            <td class="text-end"></td>
                            <td class="text-end"></td>
                            <td class="text-end">@Model.FormatearDato(Model.ListaDatos.LastOrDefault()?.saldo_final ?? 0, FormatDato.Monto)</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div class="p-2">
            <p class="small text-muted mb-0">
                <i class="bx bx-info-circle"></i> 
                Doble clic en una fecha para ver el detalle.
            </p>
        </div>
    </div>
</div>


<style>
    /* Estilo para filas seleccionadas con click simple */
    #tbMayorDiario tbody tr.selected-simple {
        background-color: #f0f0f0 !important;
    }

    /* Estilo para filas seleccionadas con doble click (estilo bordo) */
    #tbMayorDiario tbody tr.selectedEdit-row {
        background-color: firebrick !important;
        color: white !important;
        font-weight: bold;
    }

    /* Estilos para saldo anterior y actual */
    .saldo-anterior, .saldo-actual {
        background-color: #f8f9fa !important;
        font-weight: bold;
    }

    .saldo-actual {
        background-color: #e9ecef !important;
    }
</style>
